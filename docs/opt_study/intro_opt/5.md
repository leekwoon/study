---
layout: page-sidenav
group: "Introduction to Optimization"
title: "5. Duality"
---

Outline
-------
> 지금까지 Existence, Convex sets and functions, Convex optimization 을 배웠다.
> Constrained Optimization 과 더불어 Optimization 의 꽃이라 할 수 있는 Duality 를 배워보자.

Lagrangian
----------

- 다음과 같은 constrained optimization 문제를 고려해보자.

$\underset{x}{\text{min}}f(x)$

$\text{s.t. } f_i(x) \le 0, \; \forall i=1,2,...,m$

$h_i(x) = 0,  \; i = 1,2,...,p$

- where the domain is $D$
- And its optimal point is $p^*$

**Lagrangian**

- Lagrangian defined on $L$ : $\mathbf{R^n} \times \mathbf{R^m} \times \mathbf{R^p} \to D\times \mathbf{R^m} \times \mathbf{R^p}$

$L(x,\lambda,\nu) = f(x)+\sum_{i=1}^m \lambda_i f_i(x)+\sum_{i=1}^m \nu_i h_i(x) \\
=f(x)+\lambda^T f(x)+\nu^T h(x)$

- 이때, $\lambda_i$, $\nu_i$ 는 $f_i(x)$, $h_i(x)$ 에 대한 Lagrangian multiplier 이라 한다.
- duality 를 적용하기 이전의 original problem 을 primal problem 이라 한다. (새로 최적화 할 dual problem 은 뒤에서 정의 할 것)

**Dual function**

- Dual function $g$ defined on $g$: $\mathbf{R^m} \times \mathbf{R^p} \to \mathbf{R}$

$g(\lambda,\nu) = \inf_{x\in D}L(x,\lambda,\nu)\\
=\inf_{x\in D} f(x)+\sum_{i=1}^m \lambda_i f_i(x)+\sum_{i=1}^m \nu_i h_i(x) \\
=\inf_{x\in D} f(x)+\lambda^T f(x)+\nu^T h(x)$

- dual function 은 $\lambda,\nu$ 에 대해 affine 하다.
- 참고로, original problem 의 **convex 여부에 상관 없이** dual function $g$는 **concave** 하다.
- dual function 은 concave 한 pointwise infimum 함수이다. (pointwise supremum 이 convex 하므로)
- 뒤에서 배울 duality gap 과 연결해서 생각해 보자.
- 주어진 모든 constraint 를 만족하는 $\bar{x}$ 와 original problem 의 optimal value $p^*$ 를 가정해보자.
- **$\lambda \ge 0$ 을 만족한다면,**
- $f(\bar{x}) \le 0$ , $h(\bar{x}) =0$ 이기 때문에,

$\lambda^T f(\bar{x})+\nu^T h(\bar{x}) \le 0$

- 위의 식을 이용하면

$L(\bar{x},\lambda,\nu) = f(\bar{x})+\lambda^T f(\bar{x})+\nu^T h(\bar{x}) \le f(\bar{x})$

- 모든 $\bar{x}$ 에 대해 위의 식이 만족하기 때문에

$g(\lambda,\nu) \le L(\bar{x},\lambda,\nu) \le f(x) \le p^*$

- original problem 의 optimal value $p^*$ 와 dual function 값 사이에 **gap 이 존재!**
- (We should have $g(\lambda,\nu) > -\infty$)
- 지금까지의 내용을 정리하자면,
	- Lagrangian and its dual function are related to a unconstrained optimization problem, since the constraints are embedded into the objective function with Lagrangian multiplier.
	- 제약조건이 있는 문제의 경우 대부분의 경우 optimize 하기가 어려워, duality 를 이용하여 제약조건이 없는 문제로 바꾼다.
	- 하지만 optimal solution 과 gap 이 존재. (related to duality gap)
	- duality gap 이 없는 조건은 뒤에서 다룰 것이다.

Dual Function: Examples
-----------------------

**Quadratic Problem**

$\underset{x}{\text{min}} \; x^{T}x \\
\text{s.t. } Ax=b$

- The Lagrangian:

$L(x,\nu)=x^{T}x-\nu^{T}(Ax-b)$

- Lagrangian 을 x 에 대해 미분

$\nabla L_{x}(x,\nu)=2x+A^{T}\nu=0 \Rightarrow x=\frac{-1}{2}A^{T}\nu$

- dual function 을 구하기 위해 Lagrangian 을 최소로 만드는 $x$ 대입

$g(\nu)=\frac{-1}{4}\nu^{T}AA^{T}\nu - b^{T}\nu$

- 참고로, 위의 식을 $\nu$ 에 관한 식으로 나타내기 위해 $\nu^{T}b$ 대신에 $b^{T}\nu$ 로 표현
- Dual function $g$ 는 $\nu$ 에 대해서 concave 하다.
- 이렇게 얻어진 Dual function 은 optimal solution 의 lower bound 이다.

$p^{*} \ge \frac{-1}{4}\nu^{T}AA^{T}\nu - b^{T}\nu$

**Linear Programming**

$\underset{x}{\text{min}} \; c^{T}x \\
\text{s.t. } Ax = b, \; x \ge 0$

- 참고로 $x \ge 0$ 은 $-x \le 0$ 으로 생각하여 $\lambda$ 대신에 $-\lambda$ 를 쓰면 된다.
- The Lagrangian:

$L(x,\lambda,\nu) = c^{T}x-\lambda^{T}x+\nu^{T}(Ax-b)\\
=-b^{T}v+(c-\lambda+A^{T}v)^{T}x$

- $L$ 은 $x$ 에 관해 affine. The dual function:

$$g(\lambda,\nu)=\underset{x}{\text{inf}} \; L(x,\lambda,\nu)=\begin{cases}
    -b^{T}\nu, & c-\lambda+A^{T}v = 0  \\
    -\infty,              & \text{otherwise}
\end{cases}$$